<!DOCTYPE html>
<html>
	<head> 
    	 <meta charset="utf-8">
     	<link rel="stylesheet" href="{{ site.baseurl }}/css/examples.css">
     	<title> GenoDiver Livestock Simulation Software </title>
     	<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110857544-1"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		  gtag('config', 'UA-110857544-1');
		</script>
		<script>
			function ParameterFileSummary()
			{
				var x = document.getElementById("parametersummary");
				if(x.style.display === "none"){
				x.style.display = "block";
				} else {x.style.display = "none";}
			}
		</script>
   	</head> 
	<body>

	<div id = "header" >
   		<div id = "maintitle" >  GenoDiver </div>
   		<div id = "subtitle" > A Coalescent Forward in Time Simulation Toolkit </div>	
   		<div id = "navigation" > 
   			<a href = "index.html"> Home </a> &emsp;
   			<a href = "about.html"> About </a> &emsp;      
   			<a href = "parameters.html"> Parameters </a> &emsp;
   			<a href = "outputfiles.html"> Output Files </a> &emsp;
   			<a href = "examples.html"> Examples </a>
   		</div>
   	</div>
	<br>
	
	<div id = "parameterclass">
	 	<font color="black"> Simulating a Fitness Trait </font>
	</div>	 	
	<br> <br>

	<div id = "textbox">
		<div id = "text">
	 		&emsp; The parameter file below illustrates how to simulate a fitness trait only. When simulating a fitness trait it is important to 
	 		ensure that you have enough founder individuals because a portion will not make it to breeding age. Therefore, an extra 100 males and 
	 		200 females were added to the founder population to ensure enough individuals are available to generate the breeding population. This 
	 		will also impact the replacement rate because if enough progeny aren't available to remain at the chosen male and female population size 
	 		the simulation will exit. A full description of how the fitness value of an individual impacts its ability to make it to breeding age 
	 		is described in the "QTL/FTL Distribution Parameters" link.
	 		<br> <br>	  
		</div>
	</div>
	<div id = "raisedbox">
		<div id = "raisedboxtext">
			−−−−−−−|    Simulating a Fitness Trait   |−−−−−−− <br>
			−| General |− <br>
			START: sequence <br>
			SEED: 1500 <br>
			−| Genome & Marker |− <br>
			CHR: 3 <br>
			CHR_LENGTH: 150 150 150 <br>
			NUM_MARK: 4000 4000 4000 <br>
			QTL: 0 0 0 <br>
			FIT_LETHAL: 20 20 20  <br>
			FIT_SUBLETHAL: 200 200 200 <br>
			−| Population |− <br>
			FOUNDER_Effective_Size: 250 <br>
			MALE_FEMALE_FOUNDER: 150 600 random 0 <br>
			VARIANCE_A: 0.0 <br>
			VARIANCE_D: 0.0 <br>
			−| Selection |− <br>
			GENERATIONS: 25 <br>
			INDIVIDUALS: 50 0.2 400 0.2 <br>
			PROGENY: 1 <br>
			SELECTION: random high <br>
			CULLING: random 10 <br>
			-| Mating |- <br>
			MATING: random <br>
			-| OUTPUT OPTIONS |- <br>
			GENOTYPES: no <br>
		</div>
	</div>
	<br>
	<div class = "parameterclass-container">
		<a onclick = "ParameterFileSummary()" > <b> Parameter File Summary </b> 
		<div id = "parametersummary">
			<div id = "textparam">
			&emsp; Sequence information is generated for three chromosomes with a length of 150 Megabases. The genome simulated has a high degree of 
			short-range LD (250). The SNP panel contains 12,000 marker (i.e. 4,000 markers per chromosome). For each chromosome, 20 lethal and 200 
			sub-lethal mutations were generated. The quantitative trait has a broad sense heritability of 0.0 and therefore an animals phenotype is 
			only a function of random environmental deviations with a variance of 1.0. The founder population consisted of 150 males and 600 females. 
			For each generation, a total of 50 males and 400 females are in the population. A total of 10 and 80 (0.2 replacement rate) male and female 
			parents, respectively, are culled and replaced by new progeny each generation. Starting at the first generation animals are randomly selected 
			or culled each generation. The maximum number of generations an animal can remain in the breeding population is 10. Each mating pair produced 
			one progeny and parents were mated at random. <br>
		 	</div>
		</div>
	</div>
	<br>	
	<div id = "textbox">
		<div id = "text">
			&emsp; Inspection of the log file will provide summary statistics on the mean selection coefficients and degree of dominance for the lethal and sub-lethal 
			fitness effect along with their associated frequency. The default settings for the lethal mutations result in a high selection coefficient (0.72) and very little 
			dominance (0.001). Therefore the heterozygote is normal, while the unfavorable homozygote has a low fitness value. The settings for the sub-lethal mutations result in a 
			lower selection coefficient (0.03) and moderate degree of dominance (0.30). Therefore the heterozygote now has a reduced fitness value compared to the fittest homozygote. 
			Lastly, the mean allele frequency of the unfavorable allele is higher for sub-lethal compared to lethals. Below is a screenshot of the lines in the log file that display 
			the summary statistics.
		</div>
	</div>
	
	<div id = "image">
		<p><img src="{{ site.baseurl }}/images/Example4a.png" ></p>
	</div>
	
	<div id = "textbox">
		<div id = "text">
			&emsp; When a fitness trait is simulated, the animals that died due to fitness are placed in the "Low_Fitness" along with summary statistics for the respective animals. 
			 Utilizing the R code outlined below the following plots were generated to illustrate the type of information in the "Low_Fitness" file. <br>
		</div>
	</div>
	
	<br>
	<div id = "Rcode">
		<b> R-Code </b> <br>
		<div id = "textRcode">
			<span class="functioncall">rm</span><span class="keyword">(</span><span class="argument">list</span><span class="argument">=</span><span class="functioncall">ls</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span> <span class="functioncall">gc</span><span class="keyword">(</span><span class="keyword">)</span> <br>
			<span class="functioncalla">library</span><span class="keyword">(</span><span class="symbol">ggplot2</span><span class="keyword">)</span><span class="keyword">;</span> <span class="functioncalla">require</span><span class="keyword">(</span><span class="symbol">gridExtra</span><span class="keyword">)</span><span class="keyword">;</span> <span class="functioncalla">require</span><span class="keyword">(</span><span class="symbol">grid</span><span class="keyword">)</span> <br>
			<span class="functioncall">setwd</span><span class="keyword">(</span><span class="string">"/Users/jeremyhoward/Desktop/C++Code/SamplingGamates/17_GenoDiver_V2/GenoDiverFiles"</span><span class="keyword">)</span> <span class="comment">## Change</span> <br>
			<span class="comment">#############################################################################</span> <br>
			<span class="comment">### Correlation between fitness and number of homozygous lethal mutations ###</span> <br>
			<span class="comment">#############################################################################</span> <br>
			<span class="comment">## Animals that Lived ##</span> <br>
			<span class="symbol">df</span> <span class="assignement">&lt;-</span> <span class="functioncall">read.table</span><span class="keyword">(</span><span class="argument">file</span><span class="argument">=</span><span class="string">"Master_DataFrame"</span><span class="keyword">,</span><span class="argument">sep</span><span class="argument">=</span><span class="string">" "</span><span class="keyword">,</span><span class="argument">header</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">)</span>  <br>
			<span class="functioncall">ggplot</span><span class="keyword">(</span><span class="symbol">df</span><span class="keyword">,</span> <span class="functioncall">aes</span><span class="keyword">(</span><span class="argument">x</span><span class="argument">=</span><span class="symbol">Fitness</span><span class="keyword">,</span> <span class="argument">y</span> <span class="argument">=</span><span class="functioncall">as.factor</span><span class="keyword">(</span><span class="symbol">Homolethal</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">geom_point</span><span class="keyword">(</span><span class="argument">colour</span> <span class="argument">=</span> <span class="string">"red"</span><span class="keyword">,</span> <span class="argument">size</span> <span class="argument">=</span> <span class="number">3</span><span class="keyword">)</span> <span class="keyword">+</span> <br>
			&emsp; <span class="functioncall">labs</span><span class="keyword">(</span><span class="argument">title</span> <span class="argument">=</span> <span class="string">"Animals that Lived"</span><span class="keyword">,</span> <span class="argument">x</span> <span class="argument">=</span> <span class="string">"Fitness"</span><span class="keyword">,</span> <span class="argument">y</span> <span class="argument">=</span> <span class="string">"Number of Homozygous Lethal"</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">theme_bw</span><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">+</span> <br>
			&emsp; <span class="functioncall">theme</span><span class="keyword">(</span><span class="argument">plot.title</span> <span class="argument">=</span> <span class="functioncall">element_text</span><span class="keyword">(</span><span class="argument">size</span><span class="argument">=</span><span class="number">16</span><span class="keyword">,</span><span class="argument">hjust</span><span class="argument">=</span><span class="number">0.5</span><span class="keyword">)</span><span class="keyword">,</span><span class="argument">axis.title</span> <span class="argument">=</span><span class="functioncall">element_text</span><span class="keyword">(</span><span class="argument">size</span> <span class="argument">=</span> <span class="number">12</span><span class="keyword">)</span><span class="keyword">,</span><span class="argument">axis.text</span><span class="argument">=</span><span class="functioncall">element_text</span><span class="keyword">(</span><span class="argument">size</span><span class="argument">=</span><span class="number">10</span><span class="keyword">)</span><span class="keyword">)</span> <br>
			<span class="comment">## Animals that Died ##</span> <br>
			<span class="symbol">df</span> <span class="assignement">&lt;-</span> <span class="functioncall">read.table</span><span class="keyword">(</span><span class="argument">file</span><span class="argument">=</span><span class="string">"Low_Fitness"</span><span class="keyword">,</span><span class="argument">sep</span><span class="argument">=</span><span class="string">" "</span><span class="keyword">,</span><span class="argument">header</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">)</span> <br>			
			<span class="functioncall">ggplot</span><span class="keyword">(</span><span class="symbol">df</span><span class="keyword">,</span> <span class="functioncall">aes</span><span class="keyword">(</span><span class="argument">x</span><span class="argument">=</span><span class="symbol">Fitness</span><span class="keyword">,</span> <span class="argument">y</span> <span class="argument">=</span> <span class="functioncall">as.factor</span><span class="keyword">(</span><span class="symbol">Homolethal</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">geom_point</span><span class="keyword">(</span><span class="argument">colour</span> <span class="argument">=</span> <span class="string">"red"</span><span class="keyword">,</span> <span class="argument">size</span> <span class="argument">=</span> <span class="number">3</span><span class="keyword">)</span> <span class="keyword">+</span> <br>
			&emsp; <span class="functioncall">labs</span><span class="keyword">(</span><span class="argument">title</span> <span class="argument">=</span> <span class="string">"Animals that Died"</span><span class="keyword">,</span> <span class="argument">x</span> <span class="argument">=</span> <span class="string">"Fitness"</span><span class="keyword">,</span> <span class="argument">y</span> <span class="argument">=</span> <span class="string">"Number of Homozygous Lethal"</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">theme_bw</span><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">+</span> <br>
			&emsp; <span class="functioncall">theme</span><span class="keyword">(</span><span class="argument">plot.title</span><span class="argument">=</span> <span class="functioncall">element_text</span><span class="keyword">(</span><span class="argument">size</span><span class="argument">=</span><span class="number">16</span><span class="keyword">,</span><span class="argument">hjust</span><span class="argument">=</span><span class="number">0.5</span><span class="keyword">)</span><span class="keyword">,</span><span class="argument">axis.title</span> <span class="argument">=</span><span class="functioncall">element_text</span><span class="keyword">(</span><span class="argument">size</span> <span class="argument">=</span> <span class="number">12</span><span class="keyword">)</span><span class="keyword">,</span><span class="argument">axis.text</span><span class="argument">=</span><span class="functioncall">element_text</span><span class="keyword">(</span><span class="argument">size</span><span class="argument">=</span><span class="number">10</span><span class="keyword">)</span><span class="keyword">)</span> <br>
			<span class="comment">##############################################################</span> <br>
			<span class="comment">### Grab All Unique Sires and Plot Number of deaths by Sire ##</span> <br>
			<span class="comment">##############################################################</span> <br>
			<span class="symbol">df</span> <span class="assignement">&lt;-</span> <span class="functioncall">read.table</span><span class="keyword">(</span><span class="argument">file</span><span class="argument">=</span><span class="string">"Low_Fitness"</span><span class="keyword">,</span><span class="argument">sep</span><span class="argument">=</span><span class="string">" "</span><span class="keyword">,</span><span class="argument">header</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">,</span><span class="argument">colClasses</span> <span class="argument">=</span> <span class="functioncall">c</span><span class="keyword">(</span><span class="functioncall">rep</span><span class="keyword">(</span><span class="string">"numeric"</span><span class="keyword">,</span><span class="number">16</span><span class="keyword">)</span><span class="keyword">,</span><span class="string">"character"</span><span class="keyword">)</span><span class="keyword">)</span> <br>
			<span class="comment">## Get death counts by sire ##</span> <br>
			<span class="symbol">SireDeath</span> <span class="assignement">&lt;-</span> <span class="functioncall">aggregate</span><span class="keyword">(</span><span class="symbol">GV</span> <span class="keyword">~</span> <span class="symbol">Sire</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">df</span><span class="keyword">,</span><span class="argument">FUN</span><span class="argument">=</span><span class="symbol">length</span><span class="keyword">)</span> <span class="comment"># get count by sire</span> <br>
			<span class="symbol">SireDeath</span> <span class="assignement">&lt;-</span> <span class="symbol">SireDeath</span><span class="keyword">[</span><span class="functioncall">which</span><span class="keyword">(</span><span class="symbol">SireDeath</span><span class="keyword">$</span><span class="symbol">Sire</span> <span class="keyword">!=</span> <span class="number">0</span><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">]</span> <span class="comment"># remove unknown sire groups</span> <br>
			<span class="symbol">SireDeath</span> <span class="assignement">&lt;-</span> <span class="symbol">SireDeath</span><span class="keyword">[</span><span class="functioncall">order</span><span class="keyword">(</span><span class="keyword">-</span><span class="symbol">SireDeath</span><span class="keyword">$</span><span class="symbol">GV</span><span class="keyword">)</span><span class="keyword">,</span> <span class="keyword">]</span> <span class="comment"># order largest to smallest</span> <br>
			<span class="functioncall">ggplot</span><span class="keyword">(</span><span class="argument">data</span><span class="argument">=</span><span class="symbol">SireDeath</span><span class="keyword">,</span> <span class="functioncall">aes</span><span class="keyword">(</span><span class="symbol">SireDeath</span><span class="keyword">$</span><span class="symbol">GV</span><span class="keyword">)</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">geom_histogram</span><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">theme_bw</span><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">+</span> <br>
			&emsp; <span class="functioncall">ylab</span> <span class="keyword">(</span><span class="string">"Count of Sires by Number of Dead Progeny "</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">xlab</span> <span class="keyword">(</span><span class="string">"Number of Deaths for a Sire"</span><span class="keyword">)</span> <span class="keyword">+</span> <br>
			&emsp; <span class="functioncall">ggtitle</span><span class="keyword">(</span><span class="string">"Histogram of Number of \n Progeny that Died by Sire"</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">theme_bw</span><span class="keyword">(</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall">theme</span><span class="keyword">(</span><span class="argument">plot.title</span> <span class="argument">=</span><span class="functioncall">element_text</span><span class="keyword">(</span><span class="argument">hjust</span><span class="argument">=</span><span class="number">0.5</span><span class="keyword">)</span><span class="keyword">)</span> <br>
		</div>
	</div>
	<br>
		
	<div id = "image">
		<p><img src="{{ site.baseurl }}/images/Example4Figures.png" ></p>
	</div>
				
	<div id ="genodiverimage">
	  <p> <img src="{{ site.baseurl }}/images/GenoDiver.png" > </p>
	</div>
	
	</body>
</html>

